(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{2634:()=>{},6191:(e,t,a)=>{Promise.resolve().then(a.bind(a,2176))},4876:(e,t,a)=>{"use strict";a.d(t,{KD:()=>o,os:()=>i,qu:()=>n});var r=a(2120),s=a(1973),l=a.n(s);let n=async e=>{try{return(await r.A.post("/knowledge/delete_by_file",e)).data}catch(e){throw console.error("Failed to delete knowledge file:",e),e}},i=async e=>{try{return(await r.A.post("/knowledgebase/archive_file_reload",e)).data}catch(e){throw console.error("Failed to reload knowledge file:",e),e}},o=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await r.A.get("/knowledgebase/recall?".concat(l().stringify(e)))).data}catch(e){throw console.error("Failed to fetch knowledge list:",e),e}}},1841:(e,t,a)=>{"use strict";a.d(t,{f:()=>s});var r=a(2120);let s=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await r.A.post("/knowledgebase/archive_file",e)).data}catch(e){console.error(e)}}},2176:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eF});var r=a(5155),s=a(5007),l=a(7401);let n=(0,l.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var i=a(4081),o=a(8684),d=a(4085),c=a(2115),u=a(9602);let f=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,u.cn)("w-full caption-bottom text-sm",a),...s})})});f.displayName="Table";let m=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("thead",{ref:t,className:(0,u.cn)("[&_tr]:border-b",a),...s})});m.displayName="TableHeader";let p=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,u.cn)("[&_tr:last-child]:border-0",a),...s})});p.displayName="TableBody",c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,u.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s})}).displayName="TableFooter";let x=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tr",{ref:t,className:(0,u.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});x.displayName="TableRow";let h=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("th",{ref:t,className:(0,u.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})});h.displayName="TableHead";let g=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("td",{ref:t,className:(0,u.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})});g.displayName="TableCell",c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("caption",{ref:t,className:(0,u.cn)("mt-4 text-sm text-muted-foreground",a),...s})}).displayName="TableCaption";let y=(0,a(1027).F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function v(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,u.cn)(y({variant:a}),t),...s})}var N=a(3392);let j=(0,l.A)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var b=a(5686);function w(e){let{data:t,onDelete:a,onRetry:s}=e,l=e=>e&&({unprocess:{text:"上传成功",color:"bg-gray-100"},waitinglist:{text:"排队入库",color:"bg-gray-100"},processing:{text:"正在入库",color:"bg-gray-100"},processed:{text:"入库成功",color:"bg-green-100"},failed:{text:"入库失败",color:"bg-red-100"},delete_failed:{text:"删除失败",color:"bg-red-100"},deleting:{text:"删除中",color:"bg-yellow-100"}})[e]||{text:"未知状态",color:"bg-gray-100"};return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(N.F,{className:"h-[calc(100vh-291px)] w-full",children:(0,r.jsxs)(f,{children:[(0,r.jsx)(m,{className:"sticky top-0 bg-background",children:(0,r.jsxs)(x,{children:[(0,r.jsx)(h,{className:"w-[40%]",children:"文件路径"}),(0,r.jsx)(h,{className:"w-[25%]",children:"创建时间"}),(0,r.jsx)(h,{className:"w-[20%]",children:"状态"}),(0,r.jsx)(h,{className:"w-[15%] text-right",children:"操作"})]})}),(0,r.jsxs)(p,{children:[(!t||0===t.length)&&(0,r.jsx)(x,{children:(0,r.jsx)(g,{colSpan:4,className:"text-center text-gray-500",children:"暂无数据"})}),null==t?void 0:t.map((e,t)=>{let n=l(e.status),i="deleting"===e.status;return(0,r.jsxs)(x,{children:[(0,r.jsx)(g,{className:"text-blue-500 w-[40%]",children:e.file_path}),(0,r.jsx)(g,{className:"w-[25%]",children:e.create_time}),(0,r.jsx)(g,{className:"w-[20%]",children:(0,r.jsx)(v,{variant:"outline",className:"text-xs ".concat(n.color),children:n.text})}),(0,r.jsx)(g,{className:"w-[15%]",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,r.jsx)(d.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>s(e.file_path),children:(0,r.jsx)(j,{className:"h-4 w-4 text-green-500 hover:text-green-700"})}),(0,r.jsx)(d.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>a(e.file_path),disabled:i,children:(0,r.jsx)(b.A,{className:"h-4 w-4 ".concat(i?"text-gray-300":"text-gray-500 hover:text-gray-700")})})]})})]},t)})]})]})})})}var R=a(2120),A=a(1973),k=a.n(A);let C=async e=>{try{return(await R.A.get("/knowledgebase/file_list?".concat(k().stringify(e)))).data}catch(e){throw console.error("Failed to fetch knowledge file list:",e),e}},S=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await R.A.post("/knowledgebase/archive_text",e)).data}catch(e){console.error(e)}};var T=a(1841),_=a(853),D=a(2336),E=a(241);let O=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await R.A.get("/knowledgebase/file_list_count?".concat(k().stringify(e)))).data}catch(e){throw console.error("Failed to fetch knowledge list:",e),e}};var F=a(3518),P=a(6967),z=a(4858);let M=e=>{let{className:t,...a}=e;return(0,r.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,u.cn)("mx-auto flex w-full justify-center",t),...a})};M.displayName="Pagination";let I=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("ul",{ref:t,className:(0,u.cn)("flex flex-row items-center gap-1",a),...s})});I.displayName="PaginationContent";let L=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("li",{ref:t,className:(0,u.cn)("",a),...s})});L.displayName="PaginationItem";let V=e=>{let{className:t,isActive:a,size:s="icon",...l}=e;return(0,r.jsx)("a",{"aria-current":a?"page":void 0,className:(0,u.cn)((0,d.r)({variant:a?"outline":"ghost",size:s}),t),...l})};V.displayName="PaginationLink";let H=e=>{let{className:t,...a}=e;return(0,r.jsxs)(V,{"aria-label":"Go to previous page",size:"default",className:(0,u.cn)("gap-1 pl-2.5",t),...a,children:[(0,r.jsx)(F.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Previous"})]})};H.displayName="PaginationPrevious";let U=e=>{let{className:t,...a}=e;return(0,r.jsxs)(V,{"aria-label":"Go to next page",size:"default",className:(0,u.cn)("gap-1 pr-2.5",t),...a,children:[(0,r.jsx)("span",{children:"Next"}),(0,r.jsx)(P.A,{className:"h-4 w-4"})]})};U.displayName="PaginationNext";let $=e=>{let{className:t,...a}=e;return(0,r.jsxs)("span",{"aria-hidden":!0,className:(0,u.cn)("flex h-9 w-9 items-center justify-center",t),...a,children:[(0,r.jsx)(z.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"More pages"})]})};function J(e){let{currentPage:t,totalPages:a,pageSize:s,totalItems:l,onPageChange:n,onPageSizeChange:i,className:o="",pageSizeOptions:d=[10,20,30,50]}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,r.jsxs)("span",{className:"w-12",children:["共 ",l]})}),(0,r.jsx)(M,{className:o,children:(0,r.jsxs)(I,{children:[(0,r.jsx)(L,{children:(0,r.jsx)(H,{onClick:()=>t>1&&n(t-1),className:t<=1?"pointer-events-none opacity-50":"cursor-pointer"})}),(()=>{let e=[];if(a<=7)for(let t=1;t<=a;t++)e.push(t);else{e.push(1),t>3&&e.push("...");for(let r=Math.max(2,t-1);r<=Math.min(t+1,a-1);r++)e.push(r);t<a-2&&e.push("..."),e.push(a)}return e})().map((e,a)=>(0,r.jsx)(L,{children:"..."===e?(0,r.jsx)($,{}):(0,r.jsx)(V,{href:"#",onClick:t=>{t.preventDefault(),n(Number(e))},isActive:t===e,children:e})},a)),(0,r.jsx)(L,{children:(0,r.jsx)(U,{onClick:()=>t<a&&n(t+1),className:t>=a?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})}$.displayName="PaginationEllipsis";var q=a(9053),G=a(1124),W=a(7837),Z=a(5785),B=a(371),Y=a(4505);function K(e){let{open:t,onOpenChange:a,fileAddType:s,fileName:l,setFileName:n,filePath:i,setFilePath:o,fileText:u,setFileText:f,onSubmit:m,isLoading:p}=e;return(0,c.useRef)(null),(0,r.jsx)(W.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(W.Cf,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(W.c7,{children:[(0,r.jsx)(W.L3,{children:"text"===s?"知识入库":"文件入库"}),(0,r.jsx)(W.rr,{children:"添加一段文本到数据库"})]}),(0,r.jsx)("div",{className:"grid gap-4 py-4",children:"text"===s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"gap-4",children:[(0,r.jsx)(Z.J,{htmlFor:"fileName",className:"text-right",children:"文件名"}),(0,r.jsx)(D.p,{id:"fileName",placeholder:"输入文件名（选填）",className:"col-span-3",value:l,onChange:e=>n(e.target.value)})]}),(0,r.jsxs)("div",{className:"gap-4",children:[(0,r.jsx)(Z.J,{htmlFor:"fileText",className:"text-right",children:"文件内容"}),(0,r.jsx)(B.T,{id:"fileText",placeholder:"输入文件内容（按\\n对文本进行分块）",className:"col-span-3",value:u,onChange:e=>f(e.target.value)})]})]}):(0,r.jsxs)("div",{className:"grid gap-4",children:[(0,r.jsxs)("div",{className:"gap-4",children:[(0,r.jsx)(Z.J,{htmlFor:"filePath",className:"text-right",children:"文件路径"}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)(D.p,{id:"filePath",placeholder:"输入文件路径...",className:"col-span-2 flex-grow",value:i,onChange:e=>o(e.target.value)})})]}),(0,r.jsxs)("div",{className:"gap-4",children:[(0,r.jsx)(Z.J,{htmlFor:"fileName",className:"text-right",children:"文件名"}),(0,r.jsx)(D.p,{id:"fileName",placeholder:"输入文件名（选填）",className:"col-span-3",value:l,onChange:e=>n(e.target.value)})]})]})}),(0,r.jsx)(W.Es,{children:(0,r.jsx)(d.$,{type:"submit",onClick:m,disabled:p,children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y.A,{className:"mr-2 h-4 w-4 animate-spin"}),"入库中..."]}):"入库"})})]})})}var X=a(4876),Q=a(8166);function ee(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function et(...e){return t=>{let a=!1,r=e.map(e=>{let r=ee(e,t);return a||"function"!=typeof r||(a=!0),r});if(a)return()=>{for(let t=0;t<r.length;t++){let a=r[t];"function"==typeof a?a():ee(e[t],null)}}}}function ea(...e){return c.useCallback(et(...e),e)}var er=a(4993);c.forwardRef((e,t)=>{let{children:a,...s}=e,l=c.Children.toArray(a),n=l.find(en);if(n){let e=n.props.children,a=l.map(t=>t!==n?t:c.Children.count(e)>1?c.Children.only(null):c.isValidElement(e)?e.props.children:null);return(0,r.jsx)(es,{...s,ref:t,children:c.isValidElement(e)?c.cloneElement(e,void 0,a):null})}return(0,r.jsx)(es,{...s,ref:t,children:a})}).displayName="Slot";var es=c.forwardRef((e,t)=>{let{children:a,...r}=e;if(c.isValidElement(a)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=t&&"isReactWarning"in t&&t.isReactWarning;return a?e.ref:(a=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(a);return c.cloneElement(a,{...function(e,t){let a={...t};for(let r in t){let s=e[r],l=t[r];/^on[A-Z]/.test(r)?s&&l?a[r]=(...e)=>{l(...e),s(...e)}:s&&(a[r]=s):"style"===r?a[r]={...s,...l}:"className"===r&&(a[r]=[s,l].filter(Boolean).join(" "))}return{...e,...a}}(r,a.props),ref:t?et(t,e):e})}return c.Children.count(a)>1?c.Children.only(null):null});es.displayName="SlotClone";var el=({children:e})=>(0,r.jsx)(r.Fragment,{children:e});function en(e){return c.isValidElement(e)&&e.type===el}var ei="AlertDialog",[eo,ed]=(0,Q.A)(ei,[er.Hs]),ec=(0,er.Hs)(),eu=e=>{let{__scopeAlertDialog:t,...a}=e,s=ec(t);return(0,r.jsx)(er.bL,{...s,...a,modal:!0})};eu.displayName=ei,c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,l=ec(a);return(0,r.jsx)(er.l9,{...l,...s,ref:t})}).displayName="AlertDialogTrigger";var ef=e=>{let{__scopeAlertDialog:t,...a}=e,s=ec(t);return(0,r.jsx)(er.ZL,{...s,...a})};ef.displayName="AlertDialogPortal";var em=c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,l=ec(a);return(0,r.jsx)(er.hJ,{...l,...s,ref:t})});em.displayName="AlertDialogOverlay";var ep="AlertDialogContent",[ex,eh]=eo(ep),eg=c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,children:s,...l}=e,n=ec(a),i=c.useRef(null),o=ea(t,i),d=c.useRef(null);return(0,r.jsx)(er.G$,{contentName:ep,titleName:ey,docsSlug:"alert-dialog",children:(0,r.jsx)(ex,{scope:a,cancelRef:d,children:(0,r.jsxs)(er.UC,{role:"alertdialog",...n,...l,ref:o,onOpenAutoFocus:function(e,t,{checkForDefaultPrevented:a=!0}={}){return function(r){if(e?.(r),!1===a||!r.defaultPrevented)return t?.(r)}}(l.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=d.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,r.jsx)(el,{children:s}),(0,r.jsx)(eA,{contentRef:i})]})})})});eg.displayName=ep;var ey="AlertDialogTitle",ev=c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,l=ec(a);return(0,r.jsx)(er.hE,{...l,...s,ref:t})});ev.displayName=ey;var eN="AlertDialogDescription",ej=c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,l=ec(a);return(0,r.jsx)(er.VY,{...l,...s,ref:t})});ej.displayName=eN;var eb=c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,l=ec(a);return(0,r.jsx)(er.bm,{...l,...s,ref:t})});eb.displayName="AlertDialogAction";var ew="AlertDialogCancel",eR=c.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,{cancelRef:l}=eh(ew,a),n=ec(a),i=ea(t,l);return(0,r.jsx)(er.bm,{...n,...s,ref:i})});eR.displayName=ew;var eA=e=>{let{contentRef:t}=e,a="`".concat(ep,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(ep,"` by passing a `").concat(eN,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(ep,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return c.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null};let ek=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(em,{className:(0,u.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});ek.displayName=em.displayName;let eC=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsxs)(ef,{children:[(0,r.jsx)(ek,{}),(0,r.jsx)(eg,{ref:t,className:(0,u.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]})});eC.displayName=eg.displayName;let eS=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,u.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};eS.displayName="AlertDialogHeader";let eT=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,u.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};eT.displayName="AlertDialogFooter";let e_=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ev,{ref:t,className:(0,u.cn)("text-lg font-semibold",a),...s})});e_.displayName=ev.displayName;let eD=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(ej,{ref:t,className:(0,u.cn)("text-sm text-muted-foreground",a),...s})});eD.displayName=ej.displayName;let eE=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eb,{ref:t,className:(0,u.cn)((0,d.r)(),a),...s})});eE.displayName=eb.displayName;let eO=c.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eR,{ref:t,className:(0,u.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...s})});function eF(){let[e,t]=(0,c.useState)([]),[a,l]=(0,c.useState)(""),[u,f]=(0,c.useState)(!1),[m,p]=(0,c.useState)(1),[x,h]=(0,c.useState)(1),[g,y]=(0,c.useState)(10),[v,N]=(0,c.useState)(0),[j,b]=(0,c.useState)(!1),[R,A]=(0,c.useState)("text"),[k,F]=(0,c.useState)(""),[P,z]=(0,c.useState)(""),[M,I]=(0,c.useState)(""),[L,V]=(0,c.useState)(!1),[H,U]=(0,c.useState)(!1),[$,W]=(0,c.useState)("");(0,c.useEffect)(()=>{Z(),B()},[]),(0,c.useEffect)(()=>{B()},[m,g]);let Z=()=>{O({name:window.localStorage.getItem("knowledgeName")||""}).then(e=>{N(e.data||0),h(Math.ceil(e.data/g))})},B=e=>{C({name:window.localStorage.getItem("knowledgeName")||"",page:m,page_size:g,keyword:e||""}).then(e=>{e&&e.data?(t(e.data),0===e.data.length&&m>1&&p(m-1)):t([])}).catch(e=>{console.error("Failed to get file list:",e),t([]),(0,E.oR)({variant:"destructive",title:"获取文件列表失败",description:"请稍后重试"})})},Y=()=>{F(""),z(""),l(""),f(!0),b(!1)},Q=async()=>{V(!0);try{let e={name:window.localStorage.getItem("knowledgeName")||"",file_name:k,text:a};if("text"===R){let t=await S(e);200===t.code?((0,E.oR)({title:"添加文件成功",description:"文件已添加"}),l(""),B(),f(!1)):(0,E.oR)({variant:"destructive",title:"添加文件失败",description:t.msg})}else{let t=await (0,T.f)(e);200===t.code?((0,E.oR)({title:"添加文件成功",description:"文件已添加"}),f(!1)):(0,E.oR)({variant:"destructive",title:"添加文件失败",description:t.msg})}}catch(e){(0,E.oR)({variant:"destructive",title:"添加文件失败",description:"请求出错，请稍后重试"})}finally{V(!1)}},ee=(0,c.useCallback)((0,q.A)(e=>{B(e)},500),[]),et=async e=>{W(e),U(!0)},ea=async()=>{try{let e=await (0,X.qu)({name:window.localStorage.getItem("knowledgeName")||"",file_path:$});200===e.code?((0,E.oR)({title:"删除成功",description:"文件已删除"}),await Z(),m>1&&(m-1)*g>=v?p(e=>e-1):await B()):(0,E.oR)({variant:"destructive",title:"删除失败",description:e.msg||"操作失败，请重试"})}catch(e){console.error("Delete file error:",e),(0,E.oR)({variant:"destructive",title:"删除失败",description:"请求出错，请稍后重试"})}finally{U(!1)}},er=async e=>{try{let t=await (0,X.os)({name:window.localStorage.getItem("knowledgeName")||"",file_path:e});200===t.code?((0,E.oR)({title:"重试成功",description:"文件正在重新入库"}),B()):(0,E.oR)({variant:"destructive",title:"重试失败",description:t.msg})}catch(e){(0,E.oR)({variant:"destructive",title:"重试失败",description:"请求出错，请稍后重试"})}};return(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsx)("div",{className:"flex-1 px-6",children:(0,r.jsxs)(s.Zp,{className:"p-6",children:[(0,r.jsx)("h1",{className:"mb-2 text-xl font-semibold",children:"数据集"}),(0,r.jsxs)("div",{className:"mb-2.5 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-md bg-orange-50 p-3 text-orange-800",children:[(0,r.jsx)(n,{className:"h-4 w-4"}),"问题和答案只有在解析成功后才能回答。"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(_.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"}),(0,r.jsx)(D.p,{placeholder:"搜索文件",className:"pl-8",value:M,onChange:e=>{p(1);let t=e.target.value;I(t),ee(t)}})]}),(0,r.jsxs)(G.AM,{open:j,onOpenChange:b,children:[(0,r.jsx)(G.Wv,{asChild:!0,children:(0,r.jsx)(d.$,{children:"添加文件"})}),(0,r.jsx)(G.hl,{className:"w-40 p-2",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)(d.$,{variant:"ghost",className:"w-full justify-start gap-2 px-2 py-1.5 text-sm",onClick:()=>{A("text"),Y()},children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),"知识入库"]}),(0,r.jsxs)(d.$,{variant:"ghost",className:"w-full justify-start gap-2 px-2 py-1.5 text-sm",onClick:()=>{A("file"),Y()},children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),"文件入库"]})]})})]})]})]}),(0,r.jsx)(w,{data:e,onDelete:et,onRetry:er}),(0,r.jsx)(J,{currentPage:m,totalPages:x,pageSize:g,totalItems:v,onPageChange:e=>{p(e)},onPageSizeChange:e=>{y(e)},pageSizeOptions:[10,20,30,50]})]})}),(0,r.jsx)(K,{open:u,onOpenChange:f,fileAddType:R,fileName:k,setFileName:F,filePath:P,setFilePath:z,fileText:a,setFileText:l,onSubmit:Q,isLoading:L}),(0,r.jsx)(eu,{open:H,onOpenChange:U,children:(0,r.jsxs)(eC,{children:[(0,r.jsxs)(eS,{children:[(0,r.jsx)(e_,{children:"确认删除"}),(0,r.jsx)(eD,{children:"确定要删除这个文件吗？此操作无法撤销。"})]}),(0,r.jsxs)(eT,{children:[(0,r.jsx)(eO,{children:"取消"}),(0,r.jsx)(eE,{onClick:ea,className:"bg-red-500 hover:bg-red-600",children:"删除"})]})]})})]})}eO.displayName=eR.displayName},4085:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>o});var r=a(5155),s=a(2115),l=a(2317),n=a(1027),i=a(9602);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(o({variant:s,size:n,className:a})),ref:t,...c})});d.displayName="Button"},5007:(e,t,a)=>{"use strict";a.d(t,{Zp:()=>n});var r=a(5155),s=a(2115),l=a(9602);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...s})});n.displayName="Card",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",a),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})}).displayName="CardDescription",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...s})}).displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},7837:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>f,Es:()=>p,L3:()=>x,c7:()=>m,lG:()=>o,rr:()=>h,zM:()=>d});var r=a(5155),s=a(2115),l=a(4993),n=a(767),i=a(9602);let o=l.bL,d=l.l9,c=l.ZL;l.bm;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});u.displayName=l.hJ.displayName;let f=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(l.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[s,(0,r.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=l.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});x.displayName=l.hE.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});h.displayName=l.VY.displayName},2336:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var r=a(5155),s=a(2115),l=a(9602);let n=s.forwardRef((e,t)=>{let{className:a,type:s,...n}=e;return(0,r.jsx)("input",{type:s,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},5785:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(5155),s=a(2115),l=a(6195),n=a(1027),i=a(9602);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.b,{ref:t,className:(0,i.cn)(o(),a),...s})});d.displayName=l.b.displayName},1124:(e,t,a)=>{"use strict";a.d(t,{AM:()=>i,Wv:()=>o,hl:()=>d});var r=a(5155),s=a(2115),l=a(1885),n=a(9602);let i=l.bL,o=l.l9;l.Mz;let d=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:i=4,...o}=e;return(0,r.jsx)(l.ZL,{children:(0,r.jsx)(l.UC,{ref:t,align:s,sideOffset:i,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});d.displayName=l.UC.displayName},3392:(e,t,a)=>{"use strict";a.d(t,{F:()=>i});var r=a(5155),s=a(2115),l=a(1868),n=a(9602);let i=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.jsxs)(l.bL,{ref:t,className:(0,n.cn)("relative overflow-hidden",a),...i,children:[(0,r.jsx)(l.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(o,{}),(0,r.jsx)(l.OK,{})]})});i.displayName=l.bL.displayName;let o=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...i}=e;return(0,r.jsx)(l.VM,{ref:t,orientation:s,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,r.jsx)(l.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=l.VM.displayName},371:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var r=a(5155),s=a(2115),l=a(9602);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});n.displayName="Textarea"},241:(e,t,a)=>{"use strict";a.d(t,{dj:()=>f,oR:()=>u});var r=a(2115);let s=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=i(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function f(){let[e,t]=r.useState(d);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9602:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var r=a(3463),s=a(9795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},3518:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},5686:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},8684:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(7401).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},2120:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let r=a(2651).A.create({baseURL:"/api",timeout:3e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(console.error("API Error:",e),Promise.reject(e)));let s=r}},e=>{var t=t=>e(e.s=t);e.O(0,[525,197,110,849,764,846,237,441,517,358],()=>t(6191)),_N_E=e.O()}]);